(self["tmg.build"]=self["tmg.build"]||[]).push([[600,493,625,164,2,768,378,661],{181:(e,t,r)=>{e.exports=function e(t,r,n){function i(o,a){if(!r[o]){if(!t[o]){if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};t[o][0].call(c.exports,(function(e){return i(t[o][1][e]||e)}),c,c.exports,e,t,r,n)}return r[o].exports}for(var s=void 0,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";var n=e("../src/store-engine"),i=[e("../storages/localStorage"),e("../storages/sessionStorage"),e("../storages/cookieStorage"),e("../storages/memoryStorage")];t.exports=n.createStore(i,[])},{"../src/store-engine":2,"../storages/cookieStorage":4,"../storages/localStorage":5,"../storages/memoryStorage":6,"../storages/sessionStorage":7}],2:[function(e,t,r){"use strict";function n(e,t,r){r||(r=""),e&&!u(e)&&(e=[e]),t&&!u(t)&&(t=[t]);var n=r?"__storejs_"+r+"_":"",i=r?new RegExp("^"+n):null;if(!/^[a-zA-Z0-9_\-]*$/.test(r))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var h={_namespacePrefix:n,_namespaceRegexp:i,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var r=e.read(t)===t;return e.remove(t),r}catch(e){return!1}},_assignPluginFnProp:function(e,t){var r=this[t];this[t]=function(){function t(){if(r)return a(arguments,(function(e,t){n[t]=e})),r.apply(i,n)}var n=s(arguments,0),i=this,o=[t].concat(n);return e.apply(i,o)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var r="";try{r=JSON.parse(e)}catch(t){r=e}return void 0!==r?r:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(u(e))a(e,(function(e){t._addPlugin(e)}));else{var r=o(this.plugins,(function(t){return e===t}));if(!r){if(this.plugins.push(e),!g(e))throw new Error("Plugins must be function values that return objects");var n=e.call(this);if(!d(n))throw new Error("Plugins must return an object of function properties");a(n,(function(r,n){if(!g(r))throw new Error("Bad plugin property: "+n+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(r,n)}))}}},addStorage:function(e){(function(){var e="undefined"==typeof console?null:console;e&&(e.warn?e.warn:e.log).apply(e,arguments)})("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},m=c(h,p,{plugins:[]});return m.raw={},a(m,(function(e,t){g(e)&&(m.raw[t]=l(m,e))})),a(e,(function(e){m._addStorage(e)})),a(t,(function(e){m._addPlugin(e)})),m}var i=e("./util"),s=i.slice,o=i.pluck,a=i.each,l=i.bind,c=i.create,u=i.isList,g=i.isFunction,d=i.isObject;t.exports={createStore:n};var p={version:"2.0.12",enabled:!1,get:function(e,t){var r=this.storage.read(this._namespacePrefix+e);return this._deserialize(r,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each((function(r,n){e.call(t,t._deserialize(r),(n||"").replace(t._namespaceRegexp,""))}))},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return n.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return n(this.storage,this.plugins,e)}}},{"./util":3}],3:[function(e,t,n){(function(e){"use strict";function r(e,t){return Array.prototype.slice.call(e,t||0)}function n(e,t){i(e,(function(e,r){return t(e,r),!1}))}function i(e,t){if(s(e)){for(var r=0;r<e.length;r++)if(t(e[r],r))return e[r]}else for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n))return e[n]}function s(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}var o=Object.assign?Object.assign:function(e,t,r,i){for(var s=1;s<arguments.length;s++)n(Object(arguments[s]),(function(t,r){e[r]=t}));return e},a=function(){if(Object.create)return function(e,t,n,i){var s=r(arguments,1);return o.apply(this,[Object.create(e)].concat(s))};var e=function(){};return function(t,n,i,s){var a=r(arguments,1);return e.prototype=t,o.apply(this,[new e].concat(a))}}(),l=String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},c="undefined"!=typeof window?window:e;t.exports={assign:o,create:a,trim:l,bind:function(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}},slice:r,each:n,map:function(e,t){var r=s(e)?[]:{};return i(e,(function(e,n){return r[n]=t(e,n),!1})),r},pluck:i,isList:s,isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)},isObject:function(e){return e&&"[object Object]"==={}.toString.call(e)},Global:c}}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(e,t,r){"use strict";function n(e){for(var t=c.cookie.split(/; ?/g),r=t.length-1;r>=0;r--)if(l(t[r])){var n=t[r].split("="),i=unescape(n[0]);e(unescape(n[1]),i)}}function i(e){e&&s(e)&&(c.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function s(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(c.cookie)}var o=e("../src/util"),a=o.Global,l=o.trim;t.exports={name:"cookieStorage",read:function(e){if(!e||!s(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(c.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){e&&(c.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")},each:n,remove:i,clearAll:function(){n((function(e,t){i(t)}))}};var c=a.document},{"../src/util":3}],5:[function(e,t,r){"use strict";function n(){return s.localStorage}function i(e){return n().getItem(e)}var s=e("../src/util").Global;t.exports={name:"localStorage",read:i,write:function(e,t){return n().setItem(e,t)},each:function(e){for(var t=n().length-1;t>=0;t--){var r=n().key(t);e(i(r),r)}},remove:function(e){return n().removeItem(e)},clearAll:function(){return n().clear()}}},{"../src/util":3}],6:[function(e,t,r){"use strict";t.exports={name:"memoryStorage",read:function(e){return n[e]},write:function(e,t){n[e]=t},each:function(e){for(var t in n)n.hasOwnProperty(t)&&e(n[t],t)},remove:function(e){delete n[e]},clearAll:function(e){n={}}};var n={}},{}],7:[function(e,t,r){"use strict";function n(){return s.sessionStorage}function i(e){return n().getItem(e)}var s=e("../src/util").Global;t.exports={name:"sessionStorage",read:i,write:function(e,t){return n().setItem(e,t)},each:function(e){for(var t=n().length-1;t>=0;t--){var r=n().key(t);e(i(r),r)}},remove:function(e){return n().removeItem(e)},clearAll:function(){return n().clear()}}},{"../src/util":3}]},{},[1])(1)},14:(e,t,r)=>{"use strict";r.d(t,{Z:()=>u});var n=r(410),i=r(453),s=r(436),o=r(987),a=r(283),l=r(42);class c{constructor(){this.usePianoID="_utp"===window.tmg.pianoCookie,this.envsConf={staging:{pianoLibraryUrl:"https://sandbox.tinypass.com/xbuilder/experience/load?aid=AdcpxkpRsu",identityAPI:"https://api-preprod.telegraph.co.uk/identity-api-qa/identity/tokens"},prod:{pianoLibraryUrl:"https://experience.tinypass.com/xbuilder/experience/load?aid=NJu5KnOFpu",identityAPI:"https://api.telegraph.co.uk/identity/tokens"}},this.isArticle=s.Z.isArticle(),this.isGallery=s.Z.isGallery()||s.Z.isGallery2(),this.isPremium=s.Z.isPremium(),this.pianoToken=this.usePianoID?o.Z.getPianoIDToken():o.Z.getPianoRefToken(),this.userLoggedIn=o.Z.isLoggedIn(),this.userSubscriber=o.Z.isSubscriber(),this.env=new n.Z,this.currentEnv=this.env.getEnvironment(),this.isGoogleShowcase=o.Z.isGoogleShowcase(),this.isGoogleSubscriber=!1,this.isGoogleShowcase||this.init()}init(){if(this.userLoggedIn){i.Z.subscribe({topic:"tmg.swg.entitlementsReady",func:()=>{this.isGoogleSubscriber=window.tmg.googleSubscriber.entitlement,clearTimeout(e),this.pianoToken?this.loadPianoConfig(this.pianoToken):this.getNewPianoToken()}});const e=setTimeout((()=>{i.Z.unsubscribe({topic:"tmg.swg.entitlementsReady"}),this.pianoToken?this.loadPianoConfig(this.pianoToken):this.getNewPianoToken()}),1e3)}else this.usePianoID&&this.pianoToken&&l.Z.remove("__utp"),this.loadPianoConfig()}getEndpoints(e){return"prod"===e?this.envsConf.prod:this.envsConf.staging}userIsBot(){return-1!==navigator.userAgent.search(/([Ff]acebookexternalhit]|[Gg]oogle)/g)}loadPianoLibrary(){(new a.Z).injectScript(this.getEndpoints(this.currentEnv).pianoLibraryUrl)}loadPianoConfig(e=""){const t=this.getPianoData();window.tp=window.tp||[],this.usePianoID?(window.tp.push(["setUseTinypassAccounts",!1]),window.tp.push(["setUsePianoIdUserProvider",!0])):window.tp.push(["setUserRef",e]),window.tp.push(["setTags",this.getModifiedKeywords()]),window.tp.push(["addHandler","meterActive",e=>{window.tmg&&(i.Z.publish({topic:"tmg.piano.paywall.web_no_paywall"}),window.tmg.paywallMetering=e)}]),window.tp.push(["setContentCreated",new Date(s.Z.getPublishDate().replace(/-/g,"/")).toISOString()]),window.tp.push(["addHandler","experienceExecute",e=>{var t,r,n,i,s,o;const a={event:"propensityScore"},l=null==e||null===(t=e.result)||void 0===t||null===(r=t.events)||void 0===r||null===(n=r.findLast((e=>"userSegmentTrue"===e.eventType)))||void 0===n||null===(i=n.eventExecutionContext)||void 0===i||null===(s=i.userSegments)||void 0===s||null===(o=s.COMPOSER1X)||void 0===o?void 0:o.segments;if(l){const e=l.map((e=>e.replace("LTs","propensitySub").replace("LTreg","propensityReg").replace("LTreturn","propensityReturn").split(":").filter(((e,t)=>1!==t))));window.dataLayer.target=window.dataLayer.target||[],window.dataLayer.target.push(Object.assign(a,Object.fromEntries(e)))}}]),Object.keys(t).forEach((e=>{window.tp.push(["setCustomVariable",e,t[e]])})),this.loadPianoLibrary()}getModifiedKeywords(){return s.Z.getKeywords().map((e=>e.toLowerCase().replace(/ /g,"-")))}dateConversion(e){return Math.abs(new Date(1e3*e)-new Date)/864e5}getPianoData(){return{platform:"web",isPremium:this.isPremium,isArticle:this.isArticle,isGallery:this.isGallery,articleId:s.Z.getArticleId(),channel:s.Z.getChannel(),sectionId:s.Z.getCategory(),isUserBot:this.userIsBot(),isGoogleShowcase:this.isGoogleShowcase,isGoogleSubscriber:this.isGoogleSubscriber,isArticleOrGallery:this.isArticle||this.isGallery}}getNewPianoToken(){let e=o.Z.getRefreshToken(),t={grant_type:"refresh_token",refresh_token:e,client_id:"tcuk"};if(!e||""===e)return"";fetch(this.getEndpoints(this.currentEnv).identityAPI,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",ddgFlow:"transformation_login",ddgAction:"refresh_token_article"}}).then((e=>{200===e.status||201===e.status?e.json().then((e=>this.setPianoToken(e))):this.loadPianoConfig()})).catch((()=>{this.loadPianoConfig()}))}setPianoToken(e){this.usePianoID?this.loadPianoConfig():(l.Z.set("user_ref_token",e.user_ref_token,{expires:this.dateConversion(e.user_ref_token_expires_in)}),this.loadPianoConfig(e.user_ref_token))}}i.Z.subscribe({topic:"tmg.page.ready",func:()=>{new c},runIfAlreadyPublished:!0});const u=c},410:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(453),i=r(384),s=r(436);class o{constructor(){this.params={local:"local",qa:"qa",ci:"ci",staging:"staging",prod:"prod"},this.currentEnv=this.determineEnvironment(),i.Z.create("tmg.environment"),tmg.environment={currentEnv:this.currentEnv,getEnvironment:this.getEnvironment,getList:this.getList,getTld:this.getTld,isCommentingTurnedOn:this.isCommentingTurnedOn,isHttps:this.isHttps,isLocal:this.isLocal,isProd:this.isProd}}determineEnvironment(){const e=s.Z.getLocation().hostname.split(".");return e.some((e=>"local"===e||"127"===e||"localhost"===e))?this.getList().local:e.some((e=>/(^|-)ci[0-9]+(-app)?$/i.test(e)))?this.getList().ci:e.some((e=>/(^|-)qa[0-9]+(-app)?$/i.test(e)))?this.getList().qa:e.some((e=>/(^|-)staging(.*)$/i.test(e)))?this.getList().staging:this.getList().prod}getList(){return this.params}getEnvironment(){return this.currentEnv}getTld(){return"telegraph.co.uk"}isCommentingTurnedOn(){let e=!1;try{void 0!==tmg.COMMENTING_STATUS&&(e=!!tmg.COMMENTING_STATUS)}catch(e){console.log(e)}return e}isHttps(){return"https:"===s.Z.getLocation().protocol||this.isLocal()}isLocal(){return this.getEnvironment()===this.getList().local}isProd(){return this.getEnvironment()===this.getList().prod}}n.Z.subscribe({topic:"tmg.page.ready",func:new o,runIfAlreadyPublished:!0});const a=o},436:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(384),i=r(453);class s{constructor(){n.Z.create("tmg.page"),tmg.page={getMetaTag:this.getMetaTag,getMetaContent:this.getMetaContent,getPageType:this.getPageType,getPageTitle:this.getPageTitle,getChannel:this.getChannel,getBusinessSegment:this.getBusinessSegment,getCategory:this.getCategory,getContentType:this.getContentType,getArticleId:this.getArticleId,getPublishDate:this.getPublishDate,getKeywords:this.getKeywords,getLocation:this.getLocation,getLeadAssetLayout:this.getLeadAssetLayout,isArticle:this.isArticle,isSponsored:this.isSponsored,isGallery:this.isGallery,isGallery2:this.isGallery2,isPremium:this.isPremium,isApp:this.isApp.bind(this)}}getPageType(){return window.dataLayer&&window.dataLayer.pageType}getPageTitle(){return document.title}getChannel(){return this.getMetaContent("tmgads.channel")}getCategory(){return this.getMetaContent("DCSext.Category")}getBusinessSegment(){return this.getMetaContent("tmgads.businessSegment")}getContentType(){return this.getMetaContent("DCSext.Content_Type")}getArticleId(){return this.getMetaContent("tmgads.articleid")}getPublishDate(){return this.getMetaContent("DCSext.articleFirstPublished")}getKeywords(){return this.getMetaContent("keywords").split(",").map((e=>e.trim()))}getLocation(){return document.location}getMetaContent(e,t="content"){const r=this.getMetaTag(e);let n="generic";return r&&r.getAttribute(t)&&(n=r.getAttribute(t)),n}getMetaTag(e){return document.querySelector(`meta[name='${e}']`)}isArticle(){let e=!1;return["articleRenderer","articleRenderer2","longFormRenderer"].forEach((t=>{this.getPageType()===t&&(e=!0)})),e}isGallery(){return"galleryRenderer"===this.getPageType()}isGallery2(){return"galleryRenderer2"===this.getPageType()}isSponsored(){return"sponsored"===this.getBusinessSegment()}isPremium(){return"true"===this.getMetaContent("tmg.premium.state")}isApp(){return"true"===this.getMetaContent("tmg.app")}isAuthor(){return document.documentElement.hasAttribute("data-is-author")}getLeadAssetLayout(){return this.isArticle()&&document.querySelector("[data-lead-asset-layout]")?document.querySelector("[data-lead-asset-layout]").dataset.leadAssetLayout:this.isArticle()?"hidden":void 0}}i.Z.subscribe({topic:"tmg.page.ready",func:new s,runIfAlreadyPublished:!0});const o=new s},453:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(384);const i=new class{constructor(){this.topics=[],this.publishedTopics=[],this.UID=-1}subscribe({topic:e,func:t,runIfAlreadyPublished:r}){if("function"!=typeof t)return!1;if(r)for(let r=0;r<this.publishedTopics.length;r++)this.publishedTopics[r]===e&&t.call();const n=(this.UID+=1).toString();return this.topics.push({token:n,topic:e,func:t}),n}unsubscribe({topic:e}){for(let t=0;t<this.topics.length;t++)this.topics[t].topic===e&&this.topics.splice(t,1)}publish({topic:e}){this.publishedTopics.push(e);for(let t=0;t<this.topics.length;t++)this.topics[t].topic===e&&this.topics[t].func.call()}};n.Z.create("tmg.pubsub"),window.tmg.pubsub=i;const s=i},987:(e,t,r)=>{"use strict";r.d(t,{Z:()=>k});var n=r(42),i=r(978),s=r(384),o=r(470),a=r(436),l=r(453);const c={pId:"",firstName:"",lastName:"",username:"",email:"",readerType:"",subscriber:"",subButton:"",subscriptionType:"",subscriptionName:""},u={viafouraRefresh:"VfRefresh",pianoRefToken:"user_ref_token",pianoIDToken:"__utp",meterCount:"tmg_meter_count",personalisation:"tmg_p13n",publicId:"tmg_pid",registrationSuccess:"tmg_registration_success",rememberMe:"tmg_rem",session:"tmg_session",refreshToken:"tmg_refresh",subscriptionConfirmation:"tmg_subscription_confirmation"},g="ACCESS_TOKEN",d="validAppUser",p="tmg.user.mytelegraph.token",h="tmg.user.mytelegraph.onboarded.status",m=document.querySelector("html");let f={};const y=(e,t)=>{if(t||(()=>{let e=document.querySelectorAll('[class*="logged-in--"], [class*="is-subscriber--"], [class*="app-tmg-subscriber--"]');e=Array.prototype.slice.call(e),e.forEach((e=>{y(e,!0)}))})(),e)return e.className=e.className.replace(new RegExp("\\b(?:logged-in--|is-subscriber--|app-tmg-subscriber--).+\\b","g"),""),e.classList&&(e.classList.add(`logged-in--${v()}`),e.classList.add(`is-subscriber--${b()}`),e.classList.add(`app-tmg-subscriber--${_()}`)),e.classList},w=()=>{let e=n.Z.get(u.personalisation);return i.Z.tryParse(e,c)},v=()=>!!n.Z.get(u.session),b=()=>"true"===f.subscriber,S=()=>!!localStorage.getItem(g),P=()=>localStorage.getItem(d)||"{}",_=()=>{try{const e=P(),t=S(),r="TMG"===JSON.parse(e).subscriptionType;return t&&r}catch(e){return!1}},T=()=>{try{const e=P(),t=S(),r="All Digital Access"===JSON.parse(e).subscriptionName;return t&&r}catch(e){return!1}},C=()=>(window.sessionStorage.removeItem("id_token"),window.sessionStorage.removeItem("access_token"),window.localStorage.removeItem(d),window.localStorage.removeItem(g),void 0!==window.vf&&window.vf.session.logout(),n.Z.remove(u.viafouraRefresh),n.Z.remove(u.session),A(),!0),A=()=>(f=w(),y(m),f),Z={applyStatusCssClasses:y,clearAllData:()=>{C();for(let e in u)n.Z.remove(u[e]);o.Z.remove("fyre-auth"),o.Z.remove("fyre-authentication-creds"),A()},getPianoRefToken:()=>n.Z.get(u.pianoRefToken)||!1,getPianoIDToken:()=>n.Z.get(u.pianoIDToken)||!1,getMeterCount:()=>!1,getMyTelegraphToken:()=>{const e=o.Z.storage.read(p);return"undefined"!==e&&null!==e&&e},getProfile:w,getSubscriberId:()=>JSON.parse(localStorage.getItem("pid"))||"",getAccessToken:()=>localStorage.getItem(g)||"",getPublicId:()=>n.Z.get(u.publicId)||"",getSessionId:()=>n.Z.get(u.session)||"",getRefreshToken:()=>n.Z.get(u.refreshToken)||"",isLoggedIn:v,isLoggedInApp:()=>!!localStorage.getItem(d),isRegistered:()=>!!f.pId,isSubscriber:b,isAdLite:()=>!0===T()||"true"===a.Z.getMetaContent("tmg.isAdLite"),isGoogleShowcase:()=>"true"===a.Z.getMetaContent("tmg.isGoogleShowcase"),canComment:()=>v()&&b(),canCommentInApp:()=>_(),isAppTmgSubscriber:_,isAppTmgDigitalPlusSubscriber:T,isMyTelegraphOnboarded:()=>!!o.Z.storage.read(h),login:()=>(A(),!1),logout:C,setMyTelegraphToken:({token:e})=>o.Z.storage.write(p,e),setMyTelegraphOnboarded:({status:e})=>o.Z.storage.write(h,e),updateState:A};s.Z.create("tmg.user"),window.tmg.user=Z,f=A(),l.Z.publish({topic:"tmg.user.ready"});const k=Z},283:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var n=r(384),i=r(453);class s{constructor(){n.Z.create("tmg.utils"),tmg.utils={injectScript:this.injectScript,getRandomInt:this.getRandomInteger}}injectScript(e,t=!0){return new Promise(((r,n)=>{if(e){const n=document.createElement("script");n.setAttribute("src",e),n.addEventListener("load",r,!1),t&&n.setAttribute("defer","true"),document.querySelector("head").appendChild(n)}else n(Error("No src supplied"))}))}getRandomInteger(e,t){if(!e||!t)return;const r=Math.ceil(e),n=Math.floor(t);return Math.floor(Math.random()*(n-r)+r)}disableScrolling(){document.documentElement.style.overflow="hidden"}enableScrolling(){document.documentElement.style.overflow="auto"}}i.Z.subscribe({topic:"tmg.page.ready",func:new s,runIfAlreadyPublished:!0});const o=s},367:(e,t,r)=>{"use strict";var n=r(14),i=r(384),s=r(436),o=r(453),a=r(501);class l{constructor(){this.charsLimit=100,this.liveStreamBlock=!1,this.galleryComponent=document.querySelector(".gallery.component"),this.galleryContainer=document.querySelector(".gallery--wall-container"),this.articleBody=document.querySelector('[data-js="article-body"]'),this.liveStreamContainer=document.querySelector(".js-live-stream.component"),this.gallery2Container=document.querySelector('[data-js="gallery-content"]'),this.gallery2List=document.querySelectorAll('[data-js="gallery-item"]'),this.template={loginLink:a.Z.getAmendedHref("https://secure.telegraph.co.uk/secure/login/?ICID=default_paywall_v-standard_monthly-login&redirectTo="),subscribeLink:a.Z.getAmendedHref("https://www.telegraph.co.uk/customer/subscribe?ICID=default_paywall_v-standard_monthly-offer&redirectTo=")}}init(){s.Z.isArticle()?this.articleTruncation():s.Z.isGallery()?this.createPaywallGallery():s.Z.isGallery2()&&this.createNewGalleryPaywall()}articleTruncation(){let e=[...this.articleBody.querySelectorAll("p")],t=this.getTruncatedParagraph(e);if(t||(this.liveStreamBlock=!0,e=[...this.liveStreamContainer.querySelectorAll("p")],t=this.getTruncatedParagraph(e)),t){const e=t.closest(".component-content");let r=this.liveStreamContainer?t.closest(".js-live-post.component"):t.closest(".section");r||(r=t.closest(".section")),this.removeNextElements([t,r]),this.addPaywallElements(e,["premium-end-content"]),this.createPaywallArticle()}}createPaywallArticle(){this.addPaywallElements(this.liveStreamBlock?this.liveStreamContainer:this.articleBody,["premium-paywall","component"],'<div class="component-content"></div>'),this.injectPaywall()}createPaywallGallery(){this.galleryComponent.classList.add("gallery--wall"),this.addPaywallElements(this.galleryContainer,["premium-paywall","component"],'<div class="component-content"></div>'),this.injectPaywall()}createNewGalleryPaywall(){this.removeNextElements(this.gallery2List),this.addPaywallElements(this.gallery2Container,["container","premium-paywall","component"],'<div class="component-content"></div>',!0),this.injectPaywall()}removeNextElements(e=[]){e.forEach((e=>{for(;e.nextElementSibling;){let t=e.nextElementSibling;t.parentNode.removeChild(t)}}))}addPaywallElements(e,t=[],r=!1,n=!1){const i=document.createElement("div");t.forEach((e=>{i.classList.add(e)})),r&&(i.innerHTML=r),e&&(n?e.after(i):e.appendChild(i))}getTruncatedParagraph(e){let t=0,r=!1,n=!1;return e.forEach((e=>{if(t+e.textContent.trim().length>=this.charsLimit&&!r){const i=this.charsLimit-t;let s=e.textContent.trim().split(" ").slice(0,i);s=s.join(" ")+"...",e.textContent=s,n=e,t+=i,r=!0}else t+=e.textContent.trim().length})),n}injectPaywall(){const e=document.querySelector(".premium-paywall.component .component-content"),t=`\n\t\t\t<div class="default-paywall default-paywall--anon default-paywall--standard" data-test="default-paywall">\n\t\t\t\t<div class="default-paywall__header">\n\t\t\t\t\t<div class="default-paywall__headings">\n\t\t\t\t\t\t<h3 class="default-paywall__heading u-heading-5">To continue reading</h3>\n\t\t\t\t\t\t<h4 class="default-paywall__sub-heading"><span>Already a subscriber?</span>\n\t\t\t\t\t\t\t<a href="${this.template.loginLink}" class="default-paywall__textlink default-paywall__login">Log in</a>\n\t\t\t\t\t\t</h4>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="default-paywall__products">\n\t\t\t\t\t<div class="default-paywall__product default-paywall__product-subscribe">\n\t\t\t\t\t\t<div class="default-paywall__product-content">\n\t\t\t\t\t\t\t<ul class="default-paywall__product-features">\n\t\t\t\t\t\t\t\t<li class="default-paywall__product-feature">Enjoy unlimited access to all articles</li>\n\t\t\t\t\t\t\t\t<li class="default-paywall__product-feature">Choose from all our exclusive newsletters</li>\n\t\t\t\t\t\t\t\t<li class="default-paywall__product-feature">Unlock money-saving offers and events</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<a class="default-paywall__product-cta\n\t\t\t\t\t\t\t\te-button\n\t\t\t\t\t\t\t\te-button--centered-text\n\t\t\t\t\t\t\t\te-button--large"\n\t\t\t\t\t\t\thref="${this.template.subscribeLink}"\n\t\t\t\t\t\t\tdata-test="default-paywall-cta">Subscribe</a>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`;e&&(e.innerHTML=t,o.Z.publish({topic:"tmg.page.pianoready"}))}}(()=>{const e=new l;i.Z.create("tmg.PianoPaywall"),tmg.PianoPaywall=e})(),n.Z},42:(e,t,r)=>{"use strict";function n(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}r.d(t,{Z:()=>i});const i=function e(t){function r(e,i,s){var o;if(arguments.length>1){if("number"==typeof(s=n({path:"/"},r.defaults,s)).expires){var a=new Date;a.setMilliseconds(a.getMilliseconds()+864e5*s.expires),s.expires=a}try{o=JSON.stringify(i),/^[\{\[]/.test(o)&&(i=o)}catch(e){}return i=(i=encodeURIComponent(String(i))).replace(/%(20|23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(String(e))).replace(/%(20|23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[e,"=",i,s.expires&&"; expires="+s.expires.toUTCString(),s.path&&"; path="+s.path,s.domain&&"; domain="+s.domain,s.secure?"; secure":""].join("")}e||(o={});for(var l=document.cookie?document.cookie.split("; "):[],c=/(%[0-9A-Z]{2})+/g,u=0;u<l.length;u++){var g=l[u].split("="),d=g[0].replace(c,decodeURIComponent),p=g.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{if(p=t&&t(p,d)||p.replace(c,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(e){}if(e===d){o=p;break}e||(o[d]=p)}catch(e){}}return o}return r.get=r.set=r,r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(e,t){r(e,"",n(t,{expires:-1}))},r.withConverter=e,r}()},978:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r(384);let i={};const s=e=>{let t={};return"string"==typeof e&&(t=o(e.replace(/'/g,'"'))),t},o=(e,t)=>{let r=t||{},n=e,i=!1,s="",o=[],g=[],d=[];const p=/[{?,\s]\s*"([^"]|\\")+"\s*:(\s*"([^"]|\\")+"|(.+))\s*[},]/gi,h=/^\s*{?\s*'|'\s*}?\s*$/i;if(!e)return r;if("[object Object]"===Object.prototype.toString.call(e))return e;if(i=l(n),i||(d=n.match(p)||[],d.forEach((e=>{if(e.includes('"label"')){const t=e.replace(/^\s*[{\s]|[,}]\s*$/gi,"").split(":")[1].replace(/\s*"([^]+|\\")"\s*$/gi,"$1"),r=t.replace(/"/gi,'\\"'),i=e.replace(t,r);n=n.replace(e,i)}})),s=n.replace(p,""),o=s.split(/,(?=(?:[^",]*:[^",]*)|[^",]*$)/)),o.forEach((e=>{const t=e.replace(/^\s*{|}\s*$/gi,"");l(a(t))||g.push(t)})),g.forEach((e=>{let t=!1,r=e;!0===h.test(e)&&(r=u(e),t=l(a(r))),t||!0!==/[^"']\w+[^"']:/.test(r)||(r=c(r),t=l(a(r))),t&&(n=n.replace(e,r))})),i=l(n),i)r=l(n);else try{JSON.parse(n)}catch(e){console.log("tmg.json.tryParse failed:",e)}return r},a=e=>`{${e}}`,l=e=>{let t=!1;try{t=JSON.parse(e)}catch(e){}return t},c=e=>{let t=e;return t=t.replace(/^\s*(.*?):/,'"$1":'),t},u=e=>{let t=e;return t=t.replace(/^\s*'([^']+|\\')':/,'"$1":'),t=t.replace(/:\s*('')\s*$/,': ""'),t=t.replace(/:\s*'([^']+|\\')'\s*$/,': "$1"'),t};i={parseFromAem:s,tryParse:o,simpleTryParse:l},n.Z.create("tmg.json"),tmg.json=i;const g=i;tmg.parseAemJson=s},384:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i}),window.tmg=window.tmg||{};const n=function(e){try{let t=tmg,r=e.split(".");return"tmg"===r[0]&&(r=r.slice(1)),r.forEach((e=>{void 0===t[e]&&(t[e]={}),t=t[e]})),t}catch(t){console.warn("couldn't create namespace:",e)}};window.tmg.createNamespace=n;const i={create:n}},501:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var n=r(384),i=r(951),s=r(453);class o{constructor(){this.redirectSelector="[data-redirect-current]"}init(){const e=document.querySelectorAll(this.redirectSelector);e.length&&this.setRedirects(e),n.Z.create("tmg.redirect"),window.tmg.redirect={getAmendedHref:this.getAmendedHref}}setRedirects(e){e.forEach((e=>{const t=e.getAttribute("href");t&&e.setAttribute("href",this.getAmendedHref(t))}))}getAmendedHref(e){return e.indexOf("redirectTo")>-1?i.Z.updateRedirectParam(e,window.location.href):i.Z.setQuerystringParam(e,"redirectTo",window.location.href)}}s.Z.subscribe({topic:"tmg.page.ready",func:(new o).init(),runIfAlreadyPublished:!0});const a=new o},951:(e,t,r)=>{"use strict";r.d(t,{Z:()=>g});var n=r(384),i=r(436);const s=new RegExp(/\?[^#]*|(?=#)|$/),o=(()=>{const e={};return t=>e[t]||(e[t]=new RegExp(`([?&;]${t}(?=[=&;#]|$))=?([^&;#]*)`))})(),a=(e,t)=>{const r=o(t).exec(e);return r&&decodeURIComponent(r[2])},l=(e,t,r)=>{let n,l,c;return void 0===e&&(e=i.Z.getLocation().search),null===a(e,t)?(n=`${t}=${encodeURIComponent(r)}`,l=s.exec(e)[0],c=e.replace(s,(l.length?l+"&":"?")+n)):c=e.replace(o(t),`$1=${encodeURIComponent(r)}`),c},c=(e,t)=>{let r=t;if(null!==a(t,e)){let n,i=t.split("?")[0],s=(-1!==t.indexOf("?")?t.split("?")[1]:"").split("&");for(let t=s.length-1;t>=0;t-=1)n=s[t].split("=")[0],n===e&&s.splice(t,1);return r=i+(s.length>0?"?":"")+s.join("&"),r}return r},u=(e,t)=>{const r="redirectTo";return null!==a(e,r)?l(e,r,t):e};n.Z.create("tmg.GET_PARAM"),tmg.getQuerystringParam=a,tmg.setQuerystringParam=l,tmg.removeQuerystringParam=c,tmg.updateRedirectParam=u,location.search.substr(1).split("&").forEach((e=>{const t=e.split("=");t.length>1?tmg.GET_PARAM[t[0]]=decodeURIComponent(t[1]):tmg.GET_PARAM[t[0]]=""}));const g={matchParam:o,matchQuerystring:s,getQuerystringParam:a,removeQuerystringParam:c,setQuerystringParam:l,updateRedirectParam:u}},470:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});var n=r(181),i=r.n(n);r(384).Z.create("tmg.store"),tmg.store=i();const s=i()}},e=>{e(e.s=367)}]);